<!DOCTYPE html>
<html>
    <head>
        <title>Doric (again)</title>
        <meta name="viewport" content="initial-scale=1,maximum-scale=1,minimum-scale=1,width=device-width" />
        <meta charset="utf-8" />

        <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
        <link href="https://unpkg.com/ionicons@4.5.5/dist/css/ionicons.min.css" rel="stylesheet">

        <script src="https://unpkg.com/react@16.7.0/umd/react.development.js"></script>
        <script src="https://unpkg.com/react-dom@16.7.0/umd/react-dom.development.js"></script>
        <script src="https://unpkg.com/pubsub-js@1.7.0/src/pubsub.js"></script>

        <script src="https://unpkg.com/@axel669/teascript@0.14.3/standalone/transpiler.js"></script>
        <script src="https://unpkg.com/@axel669/norn@0.4.1/standalone/norn.js"></script>
        <script src="https://unpkg.com/@axel669/immutable-update@0.1.0/browser/update.js"></script>
        <script src="https://unpkg.com/ssjs@1.0.0/standalone/ss.js"></script>
        <script src="https://unpkg.com/@axel669/bind@1.0.0/standalone/bind.js"></script>
    </head>
    <body>
        <app-root></app-root>
        <script src="../standalone/doric-components.js"></script>
        <!-- <script type="text/teascript" src="inventory.tea"></script> -->
        <script type="text/teascript">
        class Main extends React.Component {
            constructor(props) => {
                super(props)
                @state = {
                    active: false
                }
            }

            render() => {
                return <div>
                    <Tabs>
                        <Tab label="test">
                            test
                        </Tab>
                        <Tab label="test #2">
                            test #2
                        </Tab>
                    </Tabs>
                </div>
            }
        }

        let tabCSS = SSJS(
            {
                "doric-tabs": {
                    display: "block"
                    "& doric-tab-bar": {
                        display: "block"
                        borderBottom: "1px solid black"
                    }
                    "& tab": {
                        display: "block"
                    }
                }
            }
            {name: "doric-tabs"}
        )
        tabCSS.generate()
        class Tabs extends React.PureComponent {
            render() => {
                let {selectedTab = 0} = @props
                let children = React.Children.toArray(@props.children)

                let list = children.map(
                    (child) => child.props.label
                )
                let displayed = children[selectedTab]

                console.log(list)

                return <doric-tabs>
                    <doric-tab-bar>
                        {list.map(
                            (label, index) => <doric-tab key=index active={index == selectedTab}>{label}</doric-tab>
                        )}
                    </doric-tab-bar>
                    {displayed}
                </doric-tabs>
            }
        }
        const Tab = (props) => <doric-tab {...props} />

        ReactDOM.render(
            <Main />
            document.querySelector("app-root")
        )
        </script>
    </body>
</html>
